@model IEnumerable<ConsultasPsicologiaMVC.Models.AgendamentoDto>
@using ConsultasPsicologiaMVC.ENUMS

@{
    ViewData["Title"] = "Gestão de Consultas";
}

<h1 class="mb-5">@ViewData["Title"]</h1>

<div style="height: 400px; overflow-y: auto;">
    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>
                    Nome do Paciente
                    <i class="fas fa-filter filter-icon" data-filter-for="NomePaciente"></i>
                    <div class="filter-dropdown" id="filterDropdownNomePaciente">
                        <select class="form-select filter-type" id="filterNomePacienteType">
                            <option value="contains">Contém</option>
                            <option value="equals">É igual a</option>
                        </select>
                        <input type="text" class="form-control mt-2" id="filterNomePaciente" placeholder="Filtrar Nome">
                        <button class="btn btn-primary btn-sm mt-2 apply-filter-btn" data-filter-id="NomePaciente">Aplicar</button>
                        <button class="btn btn-secondary btn-sm mt-2 clear-filter-btn" data-filter-id="NomePaciente">Limpar</button>
                    </div>
                </th>
                <th>
                    Data
                    <i class="fas fa-filter filter-icon" data-filter-for="Data"></i>
                    <div class="filter-dropdown" id="filterDropdownData">
                        <select class="form-select filter-type" id="filterDataType">
                            <option value="equals">É igual a</option>
                        </select>
                        <input type="text" class="form-control mt-2 datepicker" id="filterData" placeholder="DD/MM/AAAA">
                        <button class="btn btn-primary btn-sm mt-2 apply-filter-btn" data-filter-id="Data">Aplicar</button>
                        <button class="btn btn-secondary btn-sm mt-2 clear-filter-btn" data-filter-id="Data">Limpar</button>
                    </div>
                </th>
                <th>Hora</th>
                <th>
                    Tipo
                    <i class="fas fa-filter filter-icon" data-filter-for="Tipo"></i>
                    <div class="filter-dropdown" id="filterDropdownTipo">
                        <select class="form-select filter-type" id="filterTipoType">
                            <option value="equals">É igual a</option>
                        </select>
                        <select class="form-select mt-2" id="filterTipo">
                            <option value="">Todos</option>
                            <option value="VIRTUAL">Virtual</option>
                            <option value="PRESENCIAL">Presencial</option>
                        </select>
                        <button class="btn btn-primary btn-sm mt-2 apply-filter-btn" data-filter-id="Tipo">Aplicar</button>
                        <button class="btn btn-secondary btn-sm mt-2 clear-filter-btn" data-filter-id="Tipo">Limpar</button>
                    </div>
                </th>
                <th>
                    Status
                    <i class="fas fa-filter filter-icon" data-filter-for="Status"></i>
                    <div class="filter-dropdown" id="filterDropdownStatus">
                        <select class="form-select filter-type" id="filterStatusType">
                            <option value="contains">Contém</option>
                            <option value="equals">É igual a</option>
                        </select>
                        <input type="text" class="form-control mt-2" id="filterStatus" placeholder="Filtrar Status">
                        <button class="btn btn-primary btn-sm mt-2 apply-filter-btn" data-filter-id="Status">Aplicar</button>
                        <button class="btn btn-secondary btn-sm mt-2 clear-filter-btn" data-filter-id="Status">Limpar</button>
                    </div>
                </th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody id="consultasTableBody">
            @await Html.PartialAsync("_ConsultaTableRows", Model)
        </tbody>
    </table>
</div>

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center" id="paginationControls">
        <!-- Paginação será inserida via JS -->
    </ul>
</nav>

@section Scripts {
    <script src="~/js/consulta.js" asp-append-version="true"></script>
    <script>
        // Inicializa o Flatpickr para o campo de data
        $(document).ready(function () {
            flatpickr(".datepicker", {
                dateFormat: "d/m/Y",
                locale: "pt",
                allowInput: true
            });
        });
    </script>
}
